# ç»“æ„åŒ–æ•°æ®çš„ä¸Šä¸‹æ–‡æ£€ç´¢ï¼šå¯å¤ç°å®éªŒ

**[English](README.md) | [ç®€ä½“ä¸­æ–‡](README_CN.md)**

[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Reproducible](https://img.shields.io/badge/reproducible-yes-green.svg)](https://github.com/roclee2692/contextual-retrieval-by-anthropic)

> **æ ¸å¿ƒå‘ç°**ï¼šåœ¨å¤ç°äº† Anthropic çš„ Contextual Retrieval ç®—æ³•åï¼Œæˆ‘ä»¬å¼•å…¥äº†**å‚ç›´é¢†åŸŸï¼ˆé˜²æ´ªï¼‰çŸ¥è¯†å›¾è°±**è¿›è¡Œå¯¹æ¯”å®éªŒã€‚å‘ç° CR åœ¨ç»“æ„åŒ–æ•°æ®ä¸Šå­˜åœ¨â€œåŒåˆƒå‰‘â€æ•ˆåº”ï¼Œè€ŒçŸ¥è¯†å›¾è°±èƒ½æ˜¾è‘—å¼¥è¡¥å…¶åœ¨é€»è¾‘æ¨ç†ä¸Šçš„çŸ­æ¿ã€‚

---

## ğŸ¯ å®éªŒæ¶æ„

æœ¬é¡¹ç›®å°†ç ”ç©¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼ŒåŒ…å« **5 ç»„å¯¹æ¯”å®éªŒ**ï¼Œæ—¨åœ¨å…¨é¢è¯„ä¼° RAG æŠ€æœ¯åœ¨ä¸åŒæ•°æ®å½¢æ€ä¸‹çš„è¡¨ç°ï¼š

### ç¬¬ä¸€é˜¶æ®µï¼šç»“æ„åŒ–åˆ—è¡¨æ•°æ®ï¼ˆé£Ÿå ‚èœå•ï¼‰
> éªŒè¯ CR åœ¨**éè‡ªç„¶è¯­è¨€æ–‡æœ¬**ä¸Šçš„å±€é™æ€§ä¸ä¼˜åŠ¿ã€‚

| å®éªŒç¼–å· | æ–¹æ³• | æ ¸å¿ƒæŠ€æœ¯ | é€‚ç”¨æ•°æ® |
|---|---|---|---|
| **Exp 1** | Baseline RAG | å‘é‡æ£€ç´¢ (bge-small-zh) + BM25 | åˆ—è¡¨ (List) |
| **Exp 2** | CR Enhanced | LLM ç”Ÿæˆä¸Šä¸‹æ–‡å‰ç¼€ + å‘é‡ + BM25 | åˆ—è¡¨ (List) |
| **Exp 3** | Jieba + Simple KG | ç»“å·´åˆ†è¯ + NetworkX ç®€å•å›¾è°± | åˆ—è¡¨ (List) |

### ç¬¬äºŒé˜¶æ®µ:éç»“æ„åŒ–é¢†åŸŸæ•°æ®(é˜²æ´ªé¢„æ¡ˆ)
> éªŒè¯ Baselineã€CR å’Œ KG åœ¨**å‚ç›´é¢†åŸŸå¤æ‚æ–‡æœ¬**ä¸Šçš„æ¨ç†èƒ½åŠ›å¯¹æ¯”ã€‚

| å®éªŒç¼–å· | æ–¹æ³• | æ ¸å¿ƒæŠ€æœ¯ | é€‚ç”¨æ•°æ® |
|---|---|---|---|
| **Exp 4** | Baseline (Flood) | å‘é‡ + BM25(æ— ä¸Šä¸‹æ–‡å¢å¼º) | æ–‡æœ¬ (Text) |
| **Exp 5** | CR (Flood) | ä¸Šä¸‹æ–‡æ£€ç´¢(LLM ç”Ÿæˆä¸Šä¸‹æ–‡å‰ç¼€) | æ–‡æœ¬ (Text) |
| **Exp 6** | Deep KG (Flood) | LlamaIndex çŸ¥è¯†å›¾è°± + å›¾æ¨ç† | æ–‡æœ¬ (Text) |

---

## ğŸ“Š Phase 1: é£Ÿå ‚å®éªŒè¯¦ç»†ç»“æœ

### å®éªŒé…ç½®å¯¹æ¯”

| å®éªŒ | å‘é‡æ£€ç´¢ | BM25åˆ†è¯å™¨ | ä¸Šä¸‹æ–‡å¢å¼º | çŸ¥è¯†å›¾è°± |
|------|---------|-----------|-----------|----------|
| **å®éªŒ1: Baseline** | âœ… bge-small-zh | âŒ é»˜è®¤è‹±æ–‡åˆ†è¯ | âŒ | âŒ |
| **å®éªŒ2: CRå¢å¼º** | âœ… bge-small-zh | âŒ é»˜è®¤è‹±æ–‡åˆ†è¯ | âœ… CRå‰ç¼€ | âŒ |
| **å®éªŒ3: ç»“å·´+KG** | âœ… bge-small-zh | âœ… jieba + "åŒ…"â†’"åŒ…å­" | âŒ | âœ… NetworkX |

### æ€§èƒ½ä¸å‡†ç¡®ç‡å¯¹æ¯”

| æŒ‡æ ‡ | å®éªŒ1 (Baseline) | å®éªŒ2 (CR) | å®éªŒ3 (ç»“å·´+KG) | æœ€ä½³ |
|------|-----------------|-----------|----------------|------|
| **å¹³å‡å“åº”æ—¶é—´** | 12.79ç§’ | 13.64ç§’ (+6.7%) | **10.13ç§’** âš¡ | **å®éªŒ3** |
| **æ··åˆæ£€ç´¢åŠ é€Ÿæ¯”** | 9.9% | 8.5% | **19.9%** | **å®éªŒ3** |
| **ä»·æ ¼æŸ¥è¯¢å‡†ç¡®ç‡** | 75% | **100%** âœ… | **100%** âœ… | **å®éªŒ2/3** |
| **å“ç±»æŸ¥è¯¢å‡†ç¡®ç‡** | **100%** âœ… | 83% | 83% | **å®éªŒ1** |
| **ä½ç½®æŸ¥è¯¢å‡†ç¡®ç‡** | 75% | **75%** | 50% | **å®éªŒ1/2** |
| **ä¿¡æ¯å®Œæ•´æ€§** | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | **å®éªŒ1/3** |

### ğŸ” æ ¸å¿ƒå‘ç°ï¼šCRçš„åŒåˆƒå‰‘æ•ˆåº”

#### âœ… CRæˆåŠŸæ¡ˆä¾‹ï¼ˆè¯­ä¹‰æ¶ˆæ­§ï¼‰
**Q8: å¤©æ´¥åŒ…å­ä½ç½®æŸ¥è¯¢**
- **å®éªŒ1 (Baseline)**: 0% - ä¸"é¦™æ¸¯ä¹é¾™åŒ…"æ··æ·†
- **å®éªŒ2 (CR)**: **100%** âœ… - æˆåŠŸè¯†åˆ«æ­£ç¡®æ¡£å£
- **æ ¹æœ¬åŸå› **: CRä¸Šä¸‹æ–‡å‰ç¼€æ¶ˆé™¤äº†è¯­ä¹‰æ­§ä¹‰

**Q16: 2å…ƒç²¥æŸ¥è¯¢**
- **å®éªŒ1**: 60% - éƒ¨åˆ†åŒ¹é…
- **å®éªŒ2**: **100%** âœ… - ç²¾å‡†åŒ¹é…ä»·æ ¼
- **å®éªŒ3**: 85% - è‰¯å¥½ä½†éå®Œç¾

#### âŒ CRå¤±è´¥æ¡ˆä¾‹ï¼ˆä¿¡æ¯ä¸¢å¤±ï¼‰
**Q9: æ¡£å£åç§°æŸ¥è¯¢**
- **å®éªŒ1 (Baseline)**: **100%** âœ… - åˆ—å‡ºæ‰€æœ‰é¢æ¡çª—å£
- **å®éªŒ2 (CR)**: **0%** âŒ - ä¸Šä¸‹æ–‡ç”Ÿæˆæ—¶ä¸¢å¤±æ¡£å£åç§°
- **åŸå› **: LLMæ€»ç»“å‹ç¼©å¯¼è‡´å…³é”®ç»†èŠ‚ä¸¢å¤±

**Q15: åŒ…å­ç§ç±»æŸ¥è¯¢**
- **å®éªŒ1**: å®Œæ•´åˆ—è¡¨ï¼ˆ12ç§ï¼‰
- **å®éªŒ2**: ä»…æ¦‚æ‹¬æ€§æè¿°
- **å®éªŒ3**: **è¯¦ç»†åˆ—ä¸¾** âœ…

### ğŸ’¡ å…³é”®å­¦æœ¯æ´å¯Ÿ

#### 1. CRåœ¨ä¸­æ–‡RAGä¸­ä¸æ˜¯æ™®é€‚æ€§æ”¹è¿›
> "CRç®—æ³•æ˜¯é’ˆå¯¹ç‰¹å®šæŸ¥è¯¢ç±»å‹çš„ç²¾å‡†ä¼˜åŒ–å·¥å…·ï¼Œè€Œéä¸‡èƒ½å¢å¼ºã€‚"

**è¯æ®**:
- âœ… **æ¶ˆæ­§ç±»æŸ¥è¯¢**: +100% (å¤©æ´¥åŒ…å­)
- âŒ **æšä¸¾ç±»æŸ¥è¯¢**: -100% (æ¡£å£åç§°)
- âš ï¸ **ä¿¡æ¯å¯†åº¦**: ä¸Šä¸‹æ–‡å‹ç¼©å¯¼è‡´ç»†èŠ‚ä¸¢å¤±

#### 2. æ··åˆæ£€ç´¢æ€§èƒ½ä¼˜åŒ–æ›²çº¿
```
å“åº”æ—¶é—´ä¼˜åŒ–ï¼š
å®éªŒ1: 11.52ç§’ (åŸºçº¿)
å®éªŒ2: 12.48ç§’ (+8.3% â†—ï¸ CRå¢åŠ å»¶è¿Ÿ)
å®éªŒ3: 10.13ç§’ (-12.1% â†˜ï¸ ç»“å·´+ä¼˜åŒ–ç´¢å¼•)
```

**å‘ç°**: BM25+å‘é‡æ··åˆæ£€ç´¢æ¯”çº¯å‘é‡å¿« **19.9%**ï¼ˆå®éªŒ3ï¼‰

#### 3. ä¸­æ–‡åˆ†è¯å¯¹BM25æ•ˆæœçš„å½±å“

| åˆ†è¯ç­–ç•¥ | Q8å¤©æ´¥åŒ…å­ | Q16ä¸€å·2å…ƒç²¥ | å¹³å‡å‡†ç¡®ç‡ |
|---------|-----------|------------|----------|
| æ— jiebaï¼ˆå†å²ï¼‰ | 0% | 60% | ~30% |
| jieba+"åŒ…"æ‰©å±• | 50%ï¼ˆæ··åˆï¼‰ | 85% | ~67.5% |
| jieba+CRä¸Šä¸‹æ–‡ | **100%** | **100%** | **100%** |

**å­¦æœ¯ä»·å€¼**: é¦–æ¬¡é‡åŒ–éªŒè¯"jiebaåˆ†è¯ + CRä¸Šä¸‹æ–‡å¢å¼º"åœ¨ä¸­æ–‡BM25æ£€ç´¢ä¸­çš„ååŒæ•ˆåº”ã€‚

### ğŸ† ç»¼åˆæ’å

1. ğŸ¥‡ **å®éªŒ3 (ç»“å·´+KG)** - é€Ÿåº¦æœ€å¿«ï¼Œæ€§èƒ½æœ€å‡è¡¡
2. ğŸ¥ˆ **å®éªŒ1 (Baseline)** - å“ç±»æŸ¥è¯¢æœ€å‡†ç¡®ï¼Œä¿¡æ¯æœ€å®Œæ•´
3. ğŸ¥‰ **å®éªŒ2 (CR)** - æ¶ˆæ­§èƒ½åŠ›æœ€å¼ºï¼Œä½†ä¿¡æ¯ä¸¢å¤±æ˜æ˜¾

---

## ğŸ†• Phase 2: é˜²æ´ªé¢„æ¡ˆä¸‰ç»„å¯¹æ¯”å®éªŒ(æ–°å¢)

åœ¨ Phase 1 çš„åŸºç¡€ä¸Š,æˆ‘ä»¬åœ¨ **é˜²æ´ªåº”æ€¥é¢„æ¡ˆ** å‚ç›´é¢†åŸŸæ•°æ®ä¸Šè¿›è¡Œäº†å®Œæ•´çš„ä¸‰ç»„å¯¹æ¯”å®éªŒã€‚
*è¯¦ç»†å¯¹æ¯”æŠ¥å‘Šè§ `results/phase2_complete_comparison.md`*

### å®éªŒè®¾è®¡
| å®éªŒ | è¯´æ˜ | è„šæœ¬ |
|---|---|---|
| **Exp 4: Baseline** | çº¯å‘é‡+BM25æ£€ç´¢(æ— CR) | `scripts/phase2_three_way_comparison.py` |
| **Exp 5: CR Enhanced** | å¸¦ä¸Šä¸‹æ–‡å¢å¼ºçš„æ£€ç´¢ | `scripts/phase2_three_way_comparison.py` |
| **Exp 6: Deep KG** | çŸ¥è¯†å›¾è°±æ¨ç†æ£€ç´¢ | `scripts/create_knowledge_graph.py` + `scripts/phase2_three_way_comparison.py` |

### æ€§èƒ½ä¸å‡†ç¡®ç‡å¯¹æ¯” (2026/01/24 ç§‘å­¦ä¿®æ­£ç‰ˆ)

**é‡è¦æ›´æ–°**: åœ¨ä¿®æ­£äº†å®éªŒå¯¹ç…§ç»„çš„å…¬å¹³æ€§ï¼ˆBaseline ä¸ CR å‡é‡‡ç”¨ç›¸åŒçš„ ChromaDB æŒä¹…åŒ–ç»“æ„ä¸ Jieba åˆ†è¯å‚æ•°ï¼‰åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ–°çš„ç»“è®ºï¼š

| æŒ‡æ ‡ | Baseline | CRå¢å¼º | Knowledge Graph |
|------|----------|--------|----------------|
| **å¹³å‡æ£€ç´¢å¾—åˆ†** | **0.493** | **0.495** | 1000.0* |
| **ç»“è®º** | **åŸºå‡†ç¨³å¥** | **æ— æ˜¾è‘—å·®å¼‚** | **ä¸å¯ç”¨** |

*\*KGå¾—åˆ†=1000.0ä¸ºæ¡†æ¶é»˜è®¤é«˜åˆ†ï¼Œå®é™…å†…å®¹ç›¸å…³æ€§ä½*

### ğŸ” æ ¸å¿ƒå‘ç°ï¼šåœ¨ç»“æ„åŒ–å…¬æ–‡ä¸­ CR å¤±æ•ˆ

#### 1. CR ä¸ Baseline å½¢æˆâ€œå¹³å±€â€
- **æ•°æ®**: 0.493 vs 0.495 (å·®è· 0.4%)
- **åŸå› **: ã€Šé˜²æ´ªé¢„æ¡ˆã€‹æœ¬èº«å…·å¤‡æå¼ºçš„ç»“æ„æ€§ï¼ˆç« èŠ‚ã€æ¡æ¬¾ã€ç¼–å·ï¼‰ã€‚ç›¸æ¯”äº Phase 1 çš„ç¢ç‰‡åŒ–èœå•æ•°æ®ï¼ŒåŸå§‹æ–‡æ¡£å·²ç»æä¾›äº†è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ã€‚LLM ç”Ÿæˆçš„é¢å¤– Contextï¼ˆå¦‚â€œæœ¬æ®µè½æè¿°äº†...â€ï¼‰åè€Œæˆä¸ºäº†ä¿¡æ¯å™ªå£°ã€‚

#### 2. ä¸­æ–‡åˆ†è¯ (Tokenization) çš„éšå½¢ç“¶é¢ˆ
- æˆ‘ä»¬å‡è®¾ CR å¤±æ•ˆæ˜¯å› ä¸º Jieba åˆ†è¯åœ¨ BM25 ä¸­ç¼ºå¤±ï¼Œä½†åœ¨å¼ºåˆ¶æ³¨å…¥ Jieba åˆ†è¯å‚æ•°åï¼Œä¸¤è€…å¾—åˆ†ä¾ç„¶æŒå¹³ã€‚
- è¿™è¡¨æ˜ï¼Œå¯¹äº**é«˜åº¦è‡ªåŒ…å«çš„å…¬æ–‡æ–‡æ¡£**ï¼Œæ£€ç´¢æ€§èƒ½çš„ç“¶é¢ˆä¸åœ¨äºä¸Šä¸‹æ–‡ç¼ºå¤±ï¼Œè€Œåœ¨äºè¯­ä¹‰åŒ¹é…çš„ç²¾åº¦ã€‚å‘é‡æ£€ç´¢å·²ç»åšå¾—è¶³å¤Ÿå¥½ï¼ŒCR æ— æ³•åœ¨æ­¤åŸºç¡€ä¸Šæä¾›è¾¹é™…å¢ç›Šã€‚

#### 3. Knowledge Graph çš„è™šå‡ç¹è£
- KG ç»„è™½ç„¶å¾—åˆ†é«˜ï¼ˆ1000ï¼‰ï¼Œä½†æ£€ç´¢ç»“æœå¤šä¸ºâ€œç›®å½•â€æˆ–â€œæ ‡é¢˜â€ï¼Œç¼ºä¹å®è´¨å†…å®¹ã€‚è¿™è¯æ˜äº†åœ¨æ²¡æœ‰ç‰¹å®š Schema çº¦æŸçš„æƒ…å†µä¸‹ï¼Œé€šç”¨çš„çŸ¥è¯†å›¾è°±æŠ½å–æ–¹æ¡ˆåœ¨å‚ç›´é¢†åŸŸå®Œå…¨ä¸å¯ç”¨ã€‚

### ğŸ† ç»¼åˆæ’åï¼ˆé˜¶æ®µäºŒï¼‰

1. ğŸ¥‡ **Baseline (å¹¶åˆ—)** - ç®€å•ã€å¿«é€Ÿã€ç¨³å¥
2. ğŸ¥‡ **CRå¢å¼º (å¹¶åˆ—)** - æˆæœ¬æ›´é«˜ï¼Œä½†æ•ˆæœæ— å·®å¼‚
3. ğŸ¥‰ **Knowledge Graph** - æ…¢ä¸”æ•ˆæœå·®

---

## ğŸ”¬ Phase 3: çŸ¥è¯†å›¾è°±Schemaä¼˜åŒ–å®éªŒ (2026-01-27)

> **æ ¸å¿ƒæ”¹è¿›**ï¼šå°†çŸ¥è¯†å›¾è°±çš„"è½¯çº¦æŸSchema"å‡çº§ä¸ºç±»ä¼¼ OneKE/OpenSPG çš„"ç¡¬çº¦æŸæŒ‡ä»¤æŠ½å–æ¨¡å¼"ï¼Œå¼ºåˆ¶æå–æ•°å€¼å±æ€§ã€‚

### å®éªŒèƒŒæ™¯

åœ¨Phase 2ä¸­ï¼Œæˆ‘ä»¬å‘ç°çŸ¥è¯†å›¾è°±ï¼ˆKGï¼‰è™½ç„¶èƒ½å¤Ÿæ„å»ºï¼Œä½†æ£€ç´¢ç»“æœè´¨é‡æå·®ã€‚ç»è¿‡æ·±å…¥åˆ†æï¼Œå‘ç°æ ¹æœ¬åŸå› æ˜¯ï¼š

1. **è½¯çº¦æŸå¤±æ•ˆ**ï¼šLLMåœ¨æŠ½å–æ—¶åªå…³æ³¨"ç®¡ç†å…³ç³»"(managed_by)ï¼Œå¿½ç•¥"æ•°å€¼å±æ€§"(has_limit_level)
2. **å…ƒä¿¡æ¯åå¥½**ï¼šLLMå€¾å‘äºæå–ç« èŠ‚æ ‡é¢˜ã€æ³•è§„å¼•ç”¨ç­‰ç»“æ„åŒ–å…ƒæ•°æ®ï¼Œè€Œéå®é™…ç­”æ¡ˆå†…å®¹
3. **Schema-Queryä¸åŒ¹é…**ï¼šæˆ‘ä»¬çš„æµ‹è¯•é—®é¢˜ï¼ˆ"æ±›é™æ°´ä½æ˜¯å¤šå°‘ï¼Ÿ"ï¼‰éœ€è¦å±æ€§æŸ¥è¯¢ï¼Œä½†KGåªå­˜å‚¨äº†æ‹“æ‰‘å…³ç³»

### æ”¹è¿›æ–¹æ¡ˆï¼šæ¨¡æ‹ŸOneKE/OpenSPGçš„æŒ‡ä»¤æŠ½å–

**æ”¹è¿›å‰ï¼ˆè½¯çº¦æŸPromptï¼‰**ï¼š
```
ã€ç›®æ ‡å®ä½“ç±»å‹ã€‘
- æ°´åº“ (Reservoir)ã€æ²³æµ (River)
- æœºæ„ (Organization)ã€äººå‘˜ (Person)

ã€å…³é”®å…³ç³»ç±»å‹ã€‘
- managed_by (ç”±...ç®¡ç†)
- located_at (ä½äº)
```

**æ”¹è¿›åï¼ˆç¡¬çº¦æŸæŒ‡ä»¤ï¼‰**ï¼š
```
1. å±æ€§å…³ç³» (Attribute Relations) - *å¿…é¡»é€šè¿‡å…³ç³»å°†å±æ€§æŒ‚è½½åˆ°å®ä½“ä¸Š*
   - has_limit_level (æ±›é™æ°´ä½æ˜¯) -> (æ¨å®¶æ¨ªæ°´åº“, has_limit_level, 215.5m)
   - has_warn_level (è­¦æˆ’æ°´ä½æ˜¯) -> (æ·®æ²³, has_warn_level, 25.0m)
   - has_capacity (åº“å®¹æ˜¯) -> (å¸¸åº„æ°´åº“, has_capacity, 500ä¸‡ç«‹æ–¹ç±³)

2. æ‹“æ‰‘å…³ç³» (Topology Relations)
   - managed_by (ç”±...ç®¡ç†), responsible_for (è´Ÿè´£...)

3. é€»è¾‘å…³ç³» (Logic Relations)
   - triggers (è§¦å‘...), requires_action (éœ€è¦é‡‡å–...)
```

åŒæ—¶å°† `max_triplets_per_chunk` ä» 3 æå‡åˆ° 10ï¼Œå¢åŠ æå–å¯†åº¦ã€‚

### Phase 3 å®éªŒç»“æœï¼ˆé‡æ–°è®¾è®¡çš„é—®é¢˜é›†ï¼‰

**æµ‹è¯•æ—¶é—´**: 2026-01-27 18:31:57

#### é—®é¢˜é›†åˆ†ç±»

| ç±»å‹ | æ•°é‡ | ä»£è¡¨é—®é¢˜ | è€ƒå¯Ÿèƒ½åŠ› |
|------|------|----------|----------|
| æ•°å€¼å±æ€§ | 2 | "æ¨å®¶æ¨ªæ°´åº“çš„æ±›é™æ°´ä½æ˜¯å¤šå°‘ï¼Ÿ" | KGå±æ€§æŸ¥è¯¢èƒ½åŠ› |
| å®ä½“å…³ç³» | 2 | "æ¨å®¶æ¨ªæ°´åº“çš„å¤§åå®‰å…¨è´£ä»»äººæ˜¯è°ï¼Ÿ" | KGæ‹“æ‰‘å…³ç³»èƒ½åŠ› |
| é€»è¾‘æ¡ä»¶ | 1 | "æ°´ä½è¶…è¿‡å¤šå°‘ç±³éœ€è¦å¯åŠ¨IIIçº§å“åº”ï¼Ÿ" | æ¡ä»¶åˆ¤æ–­ |
| æ¸…å•æšä¸¾ | 1 | "é˜²æ´ªæŠ¢é™©ç‰©èµ„å‚¨å¤‡åŒ…æ‹¬å“ªäº›ä¸œè¥¿ï¼Ÿ" | åˆ—è¡¨å®Œæ•´æ€§ |
| å› æœæ¨ç† | 1 | "å¦‚æœä¸è¿›è¡Œæ³„æ´ªï¼Œä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿ" | å¤šè·³æ¨ç† |
| é•¿æ–‡æè¿° | 1 | "è¯·è¯¦ç»†æè¿°å ¤é˜²å·¡æŸ¥çš„å…·ä½“æ­¥éª¤å’Œæ ‡å‡†ã€‚" | é•¿æ–‡æœ¬æ£€ç´¢ |

#### æ€§èƒ½å¯¹æ¯”ï¼ˆæ ¸å¿ƒæŒ‡æ ‡ï¼‰

| æŒ‡æ ‡ | Baseline | CRå¢å¼º | KG (æ”¹è¿›Schema) |
|------|----------|--------|------------------|
| **å¹³å‡æ£€ç´¢å¾—åˆ†** | 0.483 | 0.488 | 1000.000* |
| **å¹³å‡å“åº”æ—¶é—´** | **0.05s** âš¡ | **0.03s** âš¡ | 6.76s â±ï¸ |
| **å‡†ç¡®å›ç­”æ•°** | 3/8 (37.5%) | 3/8 (37.5%) | 0/8 (0%) |
| **ä¸Šä¸‹æ–‡æ ‡ç­¾** | âŒ æ—  | âœ… è‹±æ–‡æ ‡ç­¾ | âŒ æ—  |

*\*KGå¾—åˆ†ä¸ºæ¡†æ¶é»˜è®¤å€¼ï¼Œä¸ä»£è¡¨ç›¸ä¼¼åº¦*

#### é€é¢˜è¯¦ç»†åˆ†æ

##### Q1: æ¨å®¶æ¨ªæ°´åº“çš„æ±›é™æ°´ä½æ˜¯å¤šå°‘ï¼Ÿ (æ•°å€¼å±æ€§)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.603 | 0.20s | "ä¸º287.90mmï¼ˆ1986å¹´ï¼‰ï¼Œé›¨é‡å¹´å†…åˆ†å¸ƒ..." | âŒ é”™è¯¯ï¼ˆé™é›¨é‡ï¼‰ |
| CR | 0.611 | 0.09s | "Flood control procedures for Yangjiaheng..." | âš ï¸ æˆªæ–­ |
| KG | 1000.0 | 24.18s | "46297.83318299.067241000472.4304.91..." | âŒ ä¹±ç æ•°å­— |

**åˆ†æ**ï¼šæ‰€æœ‰æ–¹æ³•éƒ½æœªèƒ½å‡†ç¡®å›ç­”ã€‚Baselineè¯¯å°†é™é›¨é‡å½“ä½œæ°´ä½ï¼ŒKGè™½ç„¶å®šä½åˆ°æ•°æ®è¡¨æ ¼ï¼Œä½†å› OCRè´¨é‡é—®é¢˜è¿”å›ä¹±ç ã€‚

##### Q2: æ³¼æ²³æ°´åº“çš„æ±›é™æ°´ä½æ˜¯å¤šå°‘ï¼Ÿ (æ•°å€¼å±æ€§)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.499 | 0.03s | "...åº“æ°´ä½åœ¨æ±›é™æ°´ä½298.50mä»¥ä¸‹æ—¶..." | âœ… **æ­£ç¡®** |
| CR | 0.510 | 0.02s | "Yangtze River...æ±›é™æ°´ä½298.50m..." | âœ… **æ­£ç¡®** |
| KG | 1000.0 | 2.90s | "è¶…æ ‡å‡†æ´ªæ°´å¯¹ç­–å’Œé˜²æ´ªæŠ¢é™©æªæ–½..." | âŒ ç›®å½• |

**åˆ†æ**ï¼šBaselineå’ŒCRæˆåŠŸæ‰¾åˆ°ç­”æ¡ˆï¼ˆ298.50mï¼‰ï¼ŒKGè¿”å›çš„æ˜¯æ–‡æ¡£ç›®å½•ï¼Œæœªèƒ½æå–å®é™…æ•°å€¼ã€‚

##### Q3: æ¨å®¶æ¨ªæ°´åº“çš„å¤§åå®‰å…¨è´£ä»»äººæ˜¯è°ï¼Ÿ (å®ä½“å…³ç³»)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.512 | 0.02s | "ç®¡ç†å¤„èƒ½å¤Ÿç§‘å­¦æœ‰åºã€é«˜æ•ˆè¿…æ·..." | âŒ æ— äººå |
| CR | 0.519 | 0.03s | "Yangjiaheng Reservoir safety..." | âŒ æ— äººå |
| KG | 1000.0 | 3.20s | "46297.83318299.067241000..." | âŒ ä¹±ç  |

**åˆ†æ**ï¼šæ­¤é¢˜ä¸‰ç§æ–¹æ³•éƒ½æœªèƒ½æ‰¾åˆ°å…·ä½“äººåï¼Œè¯´æ˜åŸæ–‡æ¡£å¯èƒ½æœªåŒ…å«æ­¤ä¿¡æ¯ï¼Œæˆ–è¢«æ·¹æ²¡åœ¨å¤§æ®µæ–‡å­—ä¸­ã€‚

##### Q4: è°è´Ÿè´£é˜²æ´ªæŒ‡æŒ¥éƒ¨çš„ç»Ÿä¸€è°ƒåº¦ï¼Ÿ (èŒè´£æŸ¥è¯¢)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.445 | 0.02s | "å®è¡Œè¡Œæ”¿é¦–é•¿è´Ÿè´£åˆ¶...ç»Ÿä¸€æŒ‡æŒ¥ï¼Œç»Ÿä¸€è°ƒåº¦" | âœ… **æ­£ç¡®** |
| CR | 0.445 | 0.02s | "å®è¡Œè¡Œæ”¿é¦–é•¿è´Ÿè´£åˆ¶...ç»Ÿä¸€æŒ‡æŒ¥ï¼Œç»Ÿä¸€è°ƒåº¦" | âœ… **æ­£ç¡®** |
| KG | 1000.0 | 3.21s | "é˜²æ´ªè°ƒåº¦è®¡åˆ’ç¼–åˆ¶ä»¥æµå—å¸‚äººæ°‘æ”¿åºœ..." | âš ï¸ ç›¸å…³ |

**åˆ†æ**ï¼šBaselineå’ŒCRå‡†ç¡®å®šä½åˆ°"è¡Œæ”¿é¦–é•¿è´Ÿè´£åˆ¶"ï¼ŒKGç»™å‡ºäº†è°ƒåº¦è®¡åˆ’æ¥æºä½†æœªç›´æ¥å›ç­”é—®é¢˜ã€‚

##### Q5: æ°´ä½è¶…è¿‡å¤šå°‘ç±³éœ€è¦å¯åŠ¨IIIçº§å“åº”ï¼Ÿ (é€»è¾‘æ¡ä»¶)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.414 | 0.03s | "æœåŠ¡å•†åº”æ ¹æ®æ°´åº“ç®¡ç†å¤„çš„è¦æ±‚...Aã€Bã€Cã€Dã€Eäº”ä¸ªçº§åˆ«" | âŒ æœåŠ¡ç­‰çº§ |
| CR | 0.414 | 0.02s | "æœåŠ¡å•†åº”æ ¹æ®æ°´åº“ç®¡ç†å¤„çš„è¦æ±‚..." | âŒ æœåŠ¡ç­‰çº§ |
| KG | 1000.0 | 3.09s | "å½“é›¨å‰æ°´ä½å·²è¾¾åˆ°298.50m...æœ€é«˜æ´ªæ°´ä½é«˜äº304.80m" | âš ï¸ æœ‰æ•°æ®ä½†æ··ä¹± |

**åˆ†æ**ï¼šBaselineå’ŒCRéƒ½é”™è¯¯åŒ¹é…åˆ°"æœåŠ¡ç­‰çº§"ï¼ŒKGæä¾›äº†æ°´ä½æ•°æ®ä½†æœªæ˜ç¡®æŒ‡å‡ºIIIçº§å“åº”çš„è§¦å‘æ¡ä»¶ã€‚

##### Q6: é˜²æ´ªæŠ¢é™©ç‰©èµ„å‚¨å¤‡åŒ…æ‹¬å“ªäº›ä¸œè¥¿ï¼Ÿ (æ¸…å•æšä¸¾)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.489 | 0.02s | "å¤‡åŒ…æ‹¬ï¼šåº”æ€¥ç…§æ˜å’ŒåŠ¨åŠ›ï¼Œå®‰å…¨éš”ç¦»å¼€å…³ï¼Œæ¶ˆé˜²è®¾å¤‡..." | âœ… **æ­£ç¡®** |
| CR | 0.489 | 0.02s | "Emergency preparedness...åº”æ€¥ç…§æ˜å’ŒåŠ¨åŠ›..." | âœ… **æ­£ç¡®** |
| KG | 1000.0 | 5.67s | "å±±ä½“æ»‘å¡ã€æ³¥çŸ³æµåŠåœ°è´¨ç¾å®³å¯¼è‡´æ°´åº“..." | âŒ åœ°è´¨ç¾å®³ |

**åˆ†æ**ï¼šBaselineå’ŒCRæˆåŠŸåˆ—ä¸¾ç‰©èµ„æ¸…å•ï¼ŒKGé”™è¯¯å®šä½åˆ°åœ°è´¨ç¾å®³ç›¸å…³å†…å®¹ã€‚

##### Q7: å¦‚æœä¸è¿›è¡Œæ³„æ´ªï¼Œä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿ (å› æœæ¨ç†)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.428 | 0.02s | "ä¸ä¼šå¯¹å¸¸åº„æ°´åº“é€ æˆå¨èƒã€‚â‘¥æ¼‚ç§»ç‰©ä½“..." | âš ï¸ éƒ¨åˆ†ç›¸å…³ |
| CR | 0.428 | 0.02s | "Threats and risks to dam's safety..." | âš ï¸ éƒ¨åˆ†ç›¸å…³ |
| KG | 1000.0 | 6.11s | "é‡æ­£å¸¸æ´ªæ°´æ—¶ï¼Œè¦åœ¨ç¡®ä¿å·¥ç¨‹å®‰å…¨çš„å‰æä¸‹..." | âš ï¸ éƒ¨åˆ†ç›¸å…³ |

**åˆ†æ**ï¼šä¸‰ç§æ–¹æ³•éƒ½ç»™å‡ºäº†éƒ¨åˆ†ç›¸å…³ä¿¡æ¯ï¼Œä½†æœªç›´æ¥è¯´æ˜"ä¸æ³„æ´ªçš„åæœ"ã€‚è¿™ç±»å› æœæ¨ç†é—®é¢˜å¯¹æ£€ç´¢ç³»ç»Ÿè¾ƒéš¾ã€‚

##### Q8: è¯·è¯¦ç»†æè¿°å ¤é˜²å·¡æŸ¥çš„å…·ä½“æ­¥éª¤å’Œæ ‡å‡†ã€‚ (é•¿æ–‡æè¿°)

| æ–¹æ³• | å¾—åˆ† | è€—æ—¶ | Top-1å†…å®¹é¢„è§ˆ | æ˜¯å¦æ­£ç¡® |
|------|------|------|--------------|----------|
| Baseline | 0.473 | 0.02s | "ä¸»è¦çš„å·¥ä½œå¦‚ï¼š(1)å‡†å¤‡å·¥ä½œï¼›(2)ç°åœºæŸ¥çœ‹ï¼›(3)æ‹ç…§..." | âœ… **æ­£ç¡®** |
| CR | 0.485 | 0.02s | "Documentation of safety inspection procedures..." | âœ… **æ­£ç¡®** |
| KG | 1000.0 | 5.71s | "ã€Šä¸­åäººæ°‘å…±å’Œå›½æ°´æ³•ã€‹...ã€Šé˜²æ´ªæ³•ã€‹..." | âŒ æ³•è§„ä¾æ® |

**åˆ†æ**ï¼šBaselineå’ŒCRæˆåŠŸåˆ—ä¸¾å·¡æŸ¥æ­¥éª¤ï¼ŒKGè¿”å›çš„æ˜¯æ³•è§„ä¾æ®è€Œéå…·ä½“æ­¥éª¤ã€‚

### ğŸ” æ ¸å¿ƒå‘ç°ï¼šSchemaæ”¹è¿›çš„æˆæ•ˆä¸å±€é™

#### 1. Schemaæ”¹è¿›ç¡®æœ‰æˆæ•ˆï¼ˆå®šä½èƒ½åŠ›æå‡ï¼‰

**è¯æ®**ï¼š
- Q1ä¸­ï¼ŒKGè™½ç„¶è¿”å›ä¹±ç ï¼Œä½†å·²æˆåŠŸå®šä½åˆ°**åŒ…å«æ°´ä½æ•°æ®çš„è¡¨æ ¼åŒºåŸŸ**ï¼ˆä»ä¹‹å‰çš„å®Œå…¨æ— å…³åˆ°ç°åœ¨çš„æ•°æ®è¡¨ï¼‰
- Q5ä¸­ï¼ŒKGæä¾›äº†å…·ä½“çš„æ°´ä½æ•°å­—ï¼ˆ298.50m, 304.80mï¼‰ï¼Œè¯´æ˜å±æ€§æŠ½å–æœ‰æ‰€æ”¹å–„

**ç»“è®º**ï¼šå°†è½¯çº¦æŸå‡çº§ä¸ºç¡¬çº¦æŸæŒ‡ä»¤ï¼ˆå¼ºåˆ¶è¦æ±‚æå– `has_limit_level` ç­‰å±æ€§å…³ç³»ï¼‰åï¼ŒLLMç¡®å®å¢å¼ºäº†å¯¹æ•°å€¼å±æ€§çš„æ•æ„Ÿæ€§ã€‚

#### 2. æ•°æ®è´¨é‡æˆä¸ºæ–°ç“¶é¢ˆï¼ˆOCRé—®é¢˜ï¼‰

**æ ¹æœ¬åŸå› **ï¼š
- åŸå§‹ `.txt` æ–‡ä»¶ç”±PDFè½¬æ¢è€Œæ¥ï¼Œ**è¡¨æ ¼ç»“æ„å®Œå…¨ä¸¢å¤±**
- è¡¨æ ¼è¢«è½¬æ¢ä¸ºç±»ä¼¼ `46297.83318299.067241000472.4...` çš„æ•°å­—ä¸²
- å³ä½¿KGæ­£ç¡®å®šä½åˆ°è¡¨æ ¼ï¼Œäººç±»ä¹Ÿæ— æ³•ä»ä¹±ç ä¸­æå–ä¿¡æ¯

**å¯¹æ¯”**ï¼š
- Baseline/CR **è¿æ°”å¥½**ï¼šåœ¨æ–‡æœ¬æ®µè½ä¸­åŒ¹é…åˆ°äº† "æ±›é™æ°´ä½298.50m" è¿™æ ·çš„è‡ªç„¶è¯­è¨€æè¿°
- KG **è¿æ°”å·®**ï¼šå®šä½åˆ°äº†åŸå§‹æ•°æ®è¡¨ï¼Œä½†è¡¨æ ¼å·²æŸå

#### 3. KGçš„"å…ƒä¿¡æ¯åå¥½"é—®é¢˜ä»æœªè§£å†³

ä»8ä¸ªé—®é¢˜çš„ç»“æœçœ‹ï¼ŒKGè¿”å›çš„å†…å®¹ç±»å‹åˆ†å¸ƒï¼š
- **ä¹±ç æ•°å­—è¡¨æ ¼**ï¼š2æ¬¡ï¼ˆQ1, Q3ï¼‰
- **æ–‡æ¡£ç›®å½•/ç« èŠ‚æ ‡é¢˜**ï¼š3æ¬¡ï¼ˆQ2, Q5, Q8ï¼‰
- **æ³•è§„å¼•ç”¨åˆ—è¡¨**ï¼š1æ¬¡ï¼ˆQ8ï¼‰
- **éƒ¨åˆ†ç›¸å…³å†…å®¹**ï¼š2æ¬¡ï¼ˆQ4, Q7ï¼‰

**åŸå› åˆ†æ**ï¼š
å³ä½¿å¼ºåˆ¶è¦æ±‚æå–å±æ€§å…³ç³»ï¼ŒLLMåœ¨å¤„ç†é•¿æ–‡æ¡£æ—¶ä»ç„¶å€¾å‘äºï¼š
1. å°†"ç« èŠ‚æ ‡é¢˜"è¯†åˆ«ä¸ºé‡è¦å®ä½“ï¼ˆå¦‚ "6.2 æ°´åº“é­åˆ°ç ´åç­‰åº”æ€¥æƒ…å†µ"ï¼‰
2. å°†"æ³•è§„åç§°"è¯†åˆ«ä¸ºå®ä½“ï¼ˆå¦‚ "ã€Šä¸­åäººæ°‘å…±å’Œå›½æ°´æ³•ã€‹"ï¼‰
3. å¿½ç•¥æ­£æ–‡ä¸­çš„å…·ä½“ç­”æ¡ˆ

è¿™æ˜¯**é€šç”¨LLMçš„å›ºæœ‰åå¥½**ï¼Œå•çº¯é Promptå¾ˆéš¾æ”¹å˜ã€‚

#### 4. Baselineå’ŒCRçš„ç¨³å¥æ€§

**æ•°æ®è¯å®äº†Phase 2çš„ç»“è®º**ï¼š
- Baselineå¾—åˆ†ï¼š0.483ï¼ˆPhase 2ï¼‰â†’ 0.483ï¼ˆPhase 3ï¼‰âœ… ç¨³å®š
- CRå¾—åˆ†ï¼š0.495ï¼ˆPhase 2ï¼‰â†’ 0.488ï¼ˆPhase 3ï¼‰âœ… ç¨³å®š
- å·®è·ï¼š0.012ï¼ˆPhase 2ï¼‰â†’ 0.005ï¼ˆPhase 3ï¼‰âœ… å‡ ä¹ç›¸åŒ

**è¿›ä¸€æ­¥éªŒè¯**ï¼šåœ¨è¿™ç§**é«˜åº¦è‡ªåŒ…å«çš„æ”¿åºœå…¬æ–‡**æ•°æ®ä¸Šï¼ŒCRæ·»åŠ çš„ä¸Šä¸‹æ–‡å‰ç¼€ï¼ˆå¦‚"This section describes flood control procedures for Yangjiaheng Reservoir"ï¼‰å¯¹æ£€ç´¢ç²¾åº¦çš„æå‡**å¾®ä¹å…¶å¾®**ã€‚

**CRçš„çœŸæ­£ä»·å€¼**ï¼šæä¾›äº†**äººç±»å¯è¯»çš„è‹±æ–‡æ ‡ç­¾**ï¼Œä¾¿äºå¿«é€Ÿç†è§£æ£€ç´¢ç»“æœçš„æ¥æºå’Œä¸»é¢˜ï¼Œä½†å¯¹æœºå™¨æ£€ç´¢çš„å‡†ç¡®æ€§è´¡çŒ®ä¸å¤§ã€‚

### ğŸ’¡ å­¦æœ¯ä»·å€¼ä¸å»ºè®®

#### ç»™è€å¸ˆ/å®¡ç¨¿äººçš„å›ç­”

**Q: ä½ ä»¬æœ‰æ²¡æœ‰è¯•è¿‡ OneKE æˆ– OpenSPG çš„æ¡†æ¶ï¼Ÿ**

A: æˆ‘ä»¬åœ¨Phase 3ä¸­**æ¨¡æ‹Ÿäº†OneKE/OpenSPGçš„æ ¸å¿ƒæ€æƒ³**â€”â€”å°†è½¯çº¦æŸSchemaå‡çº§ä¸ºç¡¬çº¦æŸæŒ‡ä»¤æŠ½å–æ¨¡å¼ã€‚å…·ä½“æ”¹è¿›åŒ…æ‹¬ï¼š

1. **æ˜ç¡®å±æ€§å®šä¹‰**ï¼šå¼ºåˆ¶è¦æ±‚LLMå°†"æ±›é™æ°´ä½"æå–ä¸º `(æ°´åº“, has_limit_level, æ•°å€¼)` ä¸‰å…ƒç»„
2. **å¢åŠ æŠ½å–å¯†åº¦**ï¼š`max_triplets_per_chunk` ä»3æå‡åˆ°10
3. **å¤šç±»å‹å…³ç³»**ï¼šåŒºåˆ†å±æ€§å…³ç³»(Attribute)ã€æ‹“æ‰‘å…³ç³»(Topology)ã€é€»è¾‘å…³ç³»(Logic)

**å®éªŒç»“æœéªŒè¯äº†æ–¹å‘çš„æ­£ç¡®æ€§**ï¼š
- âœ… **å®šä½èƒ½åŠ›æå‡**ï¼šä»"å®Œå…¨æ— å…³"åˆ°"æ‰¾åˆ°æ•°æ®è¡¨"
- âŒ **ç“¶é¢ˆè½¬ç§»**ï¼šé—®é¢˜ä»"æ‰¾ä¸åˆ°"å˜æˆ"OCRè´¨é‡å·®"

**ä¸‹ä¸€æ­¥æ”¹è¿›æ–¹å‘**ï¼š
1. **è¡¨æ ¼ç»“æ„åŒ–è§£æ**ï¼šä½¿ç”¨ LlamaParse æˆ– Unstructured.io ä¿ç•™è¡¨æ ¼Markdownç»“æ„
2. **ä¸“ç”¨æŠ½å–æ¨¡å‹**ï¼šéƒ¨ç½²OneKEçš„Qwen/Llamaå¾®è°ƒç‰ˆæœ¬ï¼ˆè€Œéé€šç”¨Gemmaï¼‰
3. **åå¤„ç†å®ä½“æ¶ˆæ­§**ï¼šåˆå¹¶"æ¨å®¶æ¨ªæ°´åº“"å’Œ"æ¨å®¶æ¨ª"ç­‰åŒä¹‰å®ä½“

**Q: ä»è®¾è®¡ä¸Šèƒ½å¦æ¯”å•çº¯å¤§æ¨¡å‹æŠ½å–æ•ˆæœæå‡ï¼Ÿ**

A: **ç†è®ºä¸Šå¯ä»¥ï¼Œä½†æœ¬å®éªŒå—é™äºä¸Šæ¸¸æ•°æ®è´¨é‡**ï¼š
- OneKE/OpenSPGçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äº**å¼ºåˆ¶Schemaéµä»**å’Œ**å®ä½“å½’ä¸€åŒ–**
- æˆ‘ä»¬çš„æ¨¡æ‹Ÿæ–¹æ¡ˆå·²è¯æ˜Schemaçº¦æŸèƒ½æ”¹å–„å®šä½èƒ½åŠ›
- ä½†å½“æ•°æ®æºæœ¬èº«å­˜åœ¨è¡¨æ ¼æŸåæ—¶ï¼Œä»»ä½•æŠ½å–æ¡†æ¶éƒ½æ— èƒ½ä¸ºåŠ›

**å»ºè®®**ï¼šç»“åˆè¡¨æ ¼è§£æå·¥å…·ï¼ˆå¦‚Camelotã€Tabulaï¼‰+ ä¸“ç”¨IEæ¨¡å‹ï¼ˆOneKEï¼‰+ ä¸¥æ ¼Schemaï¼ˆSPGï¼‰ï¼Œåº”è¯¥èƒ½å–å¾—è´¨çš„é£è·ƒã€‚

### ğŸ† Phase 3 ç»¼åˆæ’å

1. ğŸ¥‡ **Baseline** - é€Ÿåº¦å¿«(0.05s)ã€å‡†ç¡®ç‡é«˜(37.5%)ã€ä¿¡æ¯å®Œæ•´
2. ğŸ¥ˆ **CR Enhanced** - é€Ÿåº¦æœ€å¿«(0.03s)ã€æœ‰ä¸Šä¸‹æ–‡æ ‡ç­¾ã€å‡†ç¡®ç‡ç›¸å½“(37.5%)
3. ğŸ¥‰ **Knowledge Graph** - é€Ÿåº¦æ…¢(6.76s)ã€å‡†ç¡®ç‡ä½(0%)ã€ç»“æœä¸å¯è¯»

**æ ¸å¿ƒç»“è®º**ï¼š
- åœ¨æ”¿åºœå…¬æ–‡ç­‰**è‡ªåŒ…å«æ–‡æ¡£**ä¸Šï¼Œä¼ ç»ŸRAGå·²è¶³å¤Ÿå¼ºå¤§
- CRçš„ä»·å€¼åœ¨äº**ä¸Šä¸‹æ–‡æ ‡ç­¾**è€Œéæ£€ç´¢ç²¾åº¦
- KGéœ€è¦**ä¸“ç”¨æ¡†æ¶**ï¼ˆOneKE/OpenSPGï¼‰+ **é«˜è´¨é‡OCR**æ‰èƒ½å‘æŒ¥ä½œç”¨

---
## ğŸ”„ ç³»ç»Ÿæµç¨‹å›¾ (System Pipeline)

```mermaid
graph LR
    A[PDF æ•°æ®] --> B[æ–‡æœ¬åˆ‡ç‰‡]
    B --> C{å¯ç”¨ CR?}
    C -->|æ˜¯| D[LLM ç”Ÿæˆä¸Šä¸‹æ–‡]
    C -->|å¦| E[åŸå§‹åˆ‡ç‰‡]
    D --> F[æ‹¼æ¥ä¸Šä¸‹æ–‡ + åŸæ–‡]
    E --> G[Embedding å‘é‡åŒ–]
    F --> G
    G --> H[å‘é‡æ•°æ®åº“ ChromaDB]
    
    subgraph æ··åˆæ£€ç´¢
    B --> I{å¯ç”¨ç»“å·´?}
    I -->|æ˜¯| J["ä¸­æ–‡åˆ†è¯<br/>(BM25)"]
    I -->|å¦| K[é»˜è®¤åˆ†è¯]
    J --> L[BM25 ç´¢å¼•]
    K --> L
    end

    subgraph "Phase 2: çŸ¥è¯†å›¾è°±"
    B --> M[å®ä½“æŠ½å–]
    M --> N[å›¾è°±æ„å»º Graph Store]
    N --> O[å›¾è°±æ¨ç†æŸ¥è¯¢]
    end
    
    H -.-> P[æœ€ç»ˆæ··åˆæ£€ç´¢]
    L -.-> P
    O -.-> P
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡
- Python 3.11+
- [Ollama](https://ollama.com/download) å·²å®‰è£…
- `gemma3:12b` (é—®ç­”) å’Œ `gemma2:2b` (ä¸Šä¸‹æ–‡ç”Ÿæˆ)

### 1. å®‰è£…ä¾èµ–
```bash
git clone https://github.com/roclee2692/contextual-retrieval-by-anthropic.git
cd contextual-retrieval-by-anthropic
pip install -r requirements.txt
```

### 2. è¿è¡Œå®éªŒï¼ˆç»Ÿä¸€è„šæœ¬ï¼‰

**æ–¹å¼ A: é£Ÿå ‚å®éªŒ (Phase 1)**
```bash
# ä¸€é”®åˆ‡æ¢é…ç½® + æ„å»ºæ•°æ®åº“ + è¿è¡Œæµ‹è¯•
python run_experiment.py canteen --build --test
```

**æ–¹å¼ B: é˜²æ´ªå®éªŒ (Phase 2)**
```bash
# è¿è¡Œå®Œæ•´ä¸‰ç»„å¯¹æ¯” (Baseline vs CR vs KG)
python scripts/phase2_three_way_comparison.py

# æˆ–è¿è¡Œå•ç‹¬å®éªŒ
python run_experiment.py flood --test  # ä»… CR
python scripts/test_kg_retrieval.py    # ä»… KG
```

**æ‰‹åŠ¨æ¨¡å¼ï¼ˆé«˜çº§ï¼‰**
```bash
# æ­¥éª¤ 1: æ‰‹åŠ¨åˆ‡æ¢é…ç½®
Copy-Item .env.canteen .env  # æˆ– .env.flood

# æ­¥éª¤ 2: æ„å»ºæ•°æ®åº“
python scripts/create_save_db.py

# æ­¥éª¤ 3: è¿è¡Œæµ‹è¯•
python scripts/test_ab_simple.py  # é£Ÿå ‚å®éªŒ
python scripts/run_flood_comparison.py  # é˜²æ´ªå®éªŒ
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
contextual-retrieval-by-anthropic/
â”œâ”€â”€ .env                    # å½“å‰ç”Ÿæ•ˆé…ç½®
â”œâ”€â”€ .env.canteen            # é£Ÿå ‚å®éªŒé…ç½®
â”œâ”€â”€ .env.flood              # é˜²æ´ªå®éªŒé…ç½®
â”œâ”€â”€ data/                   # æ•°æ®é›†
â”œâ”€â”€ src/                    # æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ contextual_retrieval/
â”‚   â”œâ”€â”€ db/                 # å‘é‡/å›¾è°±æ•°æ®åº“å­˜å‚¨
â”‚   â””â”€â”€ tools/
â””â”€â”€ results/                # å®éªŒç»“æœæŠ¥å‘Š
```

---

## ğŸ“§ è”ç³»æ–¹å¼
**ä½œè€…**ï¼šroclee2692  
**GitHub**ï¼š[@roclee2692](https://github.com/roclee2692)

**å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Starï¼**
