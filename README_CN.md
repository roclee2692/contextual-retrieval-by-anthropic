# ç»“æ„åŒ–æ•°æ®çš„ä¸Šä¸‹æ–‡æ£€ç´¢ï¼šå¯å¤ç°å®éªŒ

**[English](README.md) | [ç®€ä½“ä¸­æ–‡](README_CN.md)**

[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Reproducible](https://img.shields.io/badge/reproducible-yes-green.svg)](https://github.com/roclee2692/contextual-retrieval-by-anthropic)

> **æ ¸å¿ƒå‘ç°**ï¼šåœ¨å¤ç°äº† Anthropic çš„ Contextual Retrieval ç®—æ³•åï¼Œæˆ‘ä»¬å¼•å…¥äº†**å‚ç›´é¢†åŸŸï¼ˆé˜²æ´ªï¼‰çŸ¥è¯†å›¾è°±**è¿›è¡Œå¯¹æ¯”å®éªŒã€‚å‘ç° CR åœ¨ç»“æ„åŒ–æ•°æ®ä¸Šå­˜åœ¨â€œåŒåˆƒå‰‘â€æ•ˆåº”ï¼Œè€ŒçŸ¥è¯†å›¾è°±èƒ½æ˜¾è‘—å¼¥è¡¥å…¶åœ¨é€»è¾‘æ¨ç†ä¸Šçš„çŸ­æ¿ã€‚

---

## ğŸ¯ å®éªŒæ¶æ„

æœ¬é¡¹ç›®å°†ç ”ç©¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼ŒåŒ…å« **5 ç»„å¯¹æ¯”å®éªŒ**ï¼Œæ—¨åœ¨å…¨é¢è¯„ä¼° RAG æŠ€æœ¯åœ¨ä¸åŒæ•°æ®å½¢æ€ä¸‹çš„è¡¨ç°ï¼š

### ç¬¬ä¸€é˜¶æ®µï¼šç»“æ„åŒ–åˆ—è¡¨æ•°æ®ï¼ˆé£Ÿå ‚èœå•ï¼‰
> éªŒè¯ CR åœ¨**éè‡ªç„¶è¯­è¨€æ–‡æœ¬**ä¸Šçš„å±€é™æ€§ä¸ä¼˜åŠ¿ã€‚

| å®éªŒç¼–å· | æ–¹æ³• | æ ¸å¿ƒæŠ€æœ¯ | é€‚ç”¨æ•°æ® |
|---|---|---|---|
| **Exp 1** | Baseline RAG | å‘é‡æ£€ç´¢ (bge-small-zh) + BM25 | åˆ—è¡¨ (List) |
| **Exp 2** | CR Enhanced | LLM ç”Ÿæˆä¸Šä¸‹æ–‡å‰ç¼€ + å‘é‡ + BM25 | åˆ—è¡¨ (List) |
| **Exp 3** | Jieba + Simple KG | ç»“å·´åˆ†è¯ + NetworkX ç®€å•å›¾è°± | åˆ—è¡¨ (List) |

### ç¬¬äºŒé˜¶æ®µ:éç»“æ„åŒ–é¢†åŸŸæ•°æ®(é˜²æ´ªé¢„æ¡ˆ)
> éªŒè¯ Baselineã€CR å’Œ KG åœ¨**å‚ç›´é¢†åŸŸå¤æ‚æ–‡æœ¬**ä¸Šçš„æ¨ç†èƒ½åŠ›å¯¹æ¯”ã€‚

| å®éªŒç¼–å· | æ–¹æ³• | æ ¸å¿ƒæŠ€æœ¯ | é€‚ç”¨æ•°æ® |
|---|---|---|---|
| **Exp 4** | Baseline (Flood) | å‘é‡ + BM25(æ— ä¸Šä¸‹æ–‡å¢å¼º) | æ–‡æœ¬ (Text) |
| **Exp 5** | CR (Flood) | ä¸Šä¸‹æ–‡æ£€ç´¢(LLM ç”Ÿæˆä¸Šä¸‹æ–‡å‰ç¼€) | æ–‡æœ¬ (Text) |
| **Exp 6** | Deep KG (Flood) | LlamaIndex çŸ¥è¯†å›¾è°± + å›¾æ¨ç† | æ–‡æœ¬ (Text) |

---

## ğŸ“Š Phase 1: é£Ÿå ‚å®éªŒè¯¦ç»†ç»“æœ

### å®éªŒé…ç½®å¯¹æ¯”

| å®éªŒ | å‘é‡æ£€ç´¢ | BM25åˆ†è¯å™¨ | ä¸Šä¸‹æ–‡å¢å¼º | çŸ¥è¯†å›¾è°± |
|------|---------|-----------|-----------|----------|
| **å®éªŒ1: Baseline** | âœ… bge-small-zh | âŒ é»˜è®¤è‹±æ–‡åˆ†è¯ | âŒ | âŒ |
| **å®éªŒ2: CRå¢å¼º** | âœ… bge-small-zh | âŒ é»˜è®¤è‹±æ–‡åˆ†è¯ | âœ… CRå‰ç¼€ | âŒ |
| **å®éªŒ3: ç»“å·´+KG** | âœ… bge-small-zh | âœ… jieba + "åŒ…"â†’"åŒ…å­" | âŒ | âœ… NetworkX |

### æ€§èƒ½ä¸å‡†ç¡®ç‡å¯¹æ¯”

| æŒ‡æ ‡ | å®éªŒ1 (Baseline) | å®éªŒ2 (CR) | å®éªŒ3 (ç»“å·´+KG) | æœ€ä½³ |
|------|-----------------|-----------|----------------|------|
| **å¹³å‡å“åº”æ—¶é—´** | 12.79ç§’ | 13.64ç§’ (+6.7%) | **10.13ç§’** âš¡ | **å®éªŒ3** |
| **æ··åˆæ£€ç´¢åŠ é€Ÿæ¯”** | 9.9% | 8.5% | **19.9%** | **å®éªŒ3** |
| **ä»·æ ¼æŸ¥è¯¢å‡†ç¡®ç‡** | 75% | **100%** âœ… | **100%** âœ… | **å®éªŒ2/3** |
| **å“ç±»æŸ¥è¯¢å‡†ç¡®ç‡** | **100%** âœ… | 83% | 83% | **å®éªŒ1** |
| **ä½ç½®æŸ¥è¯¢å‡†ç¡®ç‡** | 75% | **75%** | 50% | **å®éªŒ1/2** |
| **ä¿¡æ¯å®Œæ•´æ€§** | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | **å®éªŒ1/3** |

### ğŸ” æ ¸å¿ƒå‘ç°ï¼šCRçš„åŒåˆƒå‰‘æ•ˆåº”

#### âœ… CRæˆåŠŸæ¡ˆä¾‹ï¼ˆè¯­ä¹‰æ¶ˆæ­§ï¼‰
**Q8: å¤©æ´¥åŒ…å­ä½ç½®æŸ¥è¯¢**
- **å®éªŒ1 (Baseline)**: 0% - ä¸"é¦™æ¸¯ä¹é¾™åŒ…"æ··æ·†
- **å®éªŒ2 (CR)**: **100%** âœ… - æˆåŠŸè¯†åˆ«æ­£ç¡®æ¡£å£
- **æ ¹æœ¬åŸå› **: CRä¸Šä¸‹æ–‡å‰ç¼€æ¶ˆé™¤äº†è¯­ä¹‰æ­§ä¹‰

**Q16: 2å…ƒç²¥æŸ¥è¯¢**
- **å®éªŒ1**: 60% - éƒ¨åˆ†åŒ¹é…
- **å®éªŒ2**: **100%** âœ… - ç²¾å‡†åŒ¹é…ä»·æ ¼
- **å®éªŒ3**: 85% - è‰¯å¥½ä½†éå®Œç¾

#### âŒ CRå¤±è´¥æ¡ˆä¾‹ï¼ˆä¿¡æ¯ä¸¢å¤±ï¼‰
**Q9: æ¡£å£åç§°æŸ¥è¯¢**
- **å®éªŒ1 (Baseline)**: **100%** âœ… - åˆ—å‡ºæ‰€æœ‰é¢æ¡çª—å£
- **å®éªŒ2 (CR)**: **0%** âŒ - ä¸Šä¸‹æ–‡ç”Ÿæˆæ—¶ä¸¢å¤±æ¡£å£åç§°
- **åŸå› **: LLMæ€»ç»“å‹ç¼©å¯¼è‡´å…³é”®ç»†èŠ‚ä¸¢å¤±

**Q15: åŒ…å­ç§ç±»æŸ¥è¯¢**
- **å®éªŒ1**: å®Œæ•´åˆ—è¡¨ï¼ˆ12ç§ï¼‰
- **å®éªŒ2**: ä»…æ¦‚æ‹¬æ€§æè¿°
- **å®éªŒ3**: **è¯¦ç»†åˆ—ä¸¾** âœ…

### ğŸ’¡ å…³é”®å­¦æœ¯æ´å¯Ÿ

#### 1. CRåœ¨ä¸­æ–‡RAGä¸­ä¸æ˜¯æ™®é€‚æ€§æ”¹è¿›
> "CRç®—æ³•æ˜¯é’ˆå¯¹ç‰¹å®šæŸ¥è¯¢ç±»å‹çš„ç²¾å‡†ä¼˜åŒ–å·¥å…·ï¼Œè€Œéä¸‡èƒ½å¢å¼ºã€‚"

**è¯æ®**:
- âœ… **æ¶ˆæ­§ç±»æŸ¥è¯¢**: +100% (å¤©æ´¥åŒ…å­)
- âŒ **æšä¸¾ç±»æŸ¥è¯¢**: -100% (æ¡£å£åç§°)
- âš ï¸ **ä¿¡æ¯å¯†åº¦**: ä¸Šä¸‹æ–‡å‹ç¼©å¯¼è‡´ç»†èŠ‚ä¸¢å¤±

#### 2. æ··åˆæ£€ç´¢æ€§èƒ½ä¼˜åŒ–æ›²çº¿
```
å“åº”æ—¶é—´ä¼˜åŒ–ï¼š
å®éªŒ1: 11.52ç§’ (åŸºçº¿)
å®éªŒ2: 12.48ç§’ (+8.3% â†—ï¸ CRå¢åŠ å»¶è¿Ÿ)
å®éªŒ3: 10.13ç§’ (-12.1% â†˜ï¸ ç»“å·´+ä¼˜åŒ–ç´¢å¼•)
```

**å‘ç°**: BM25+å‘é‡æ··åˆæ£€ç´¢æ¯”çº¯å‘é‡å¿« **19.9%**ï¼ˆå®éªŒ3ï¼‰

#### 3. ä¸­æ–‡åˆ†è¯å¯¹BM25æ•ˆæœçš„å½±å“

| åˆ†è¯ç­–ç•¥ | Q8å¤©æ´¥åŒ…å­ | Q16ä¸€å·2å…ƒç²¥ | å¹³å‡å‡†ç¡®ç‡ |
|---------|-----------|------------|----------|
| æ— jiebaï¼ˆå†å²ï¼‰ | 0% | 60% | ~30% |
| jieba+"åŒ…"æ‰©å±• | 50%ï¼ˆæ··åˆï¼‰ | 85% | ~67.5% |
| jieba+CRä¸Šä¸‹æ–‡ | **100%** | **100%** | **100%** |

**å­¦æœ¯ä»·å€¼**: é¦–æ¬¡é‡åŒ–éªŒè¯"jiebaåˆ†è¯ + CRä¸Šä¸‹æ–‡å¢å¼º"åœ¨ä¸­æ–‡BM25æ£€ç´¢ä¸­çš„ååŒæ•ˆåº”ã€‚

### ğŸ† ç»¼åˆæ’å

1. ğŸ¥‡ **å®éªŒ3 (ç»“å·´+KG)** - é€Ÿåº¦æœ€å¿«ï¼Œæ€§èƒ½æœ€å‡è¡¡
2. ğŸ¥ˆ **å®éªŒ1 (Baseline)** - å“ç±»æŸ¥è¯¢æœ€å‡†ç¡®ï¼Œä¿¡æ¯æœ€å®Œæ•´
3. ğŸ¥‰ **å®éªŒ2 (CR)** - æ¶ˆæ­§èƒ½åŠ›æœ€å¼ºï¼Œä½†ä¿¡æ¯ä¸¢å¤±æ˜æ˜¾

---

## ğŸ†• Phase 2: é˜²æ´ªé¢„æ¡ˆä¸‰ç»„å¯¹æ¯”å®éªŒ(æ–°å¢)

åœ¨ Phase 1 çš„åŸºç¡€ä¸Š,æˆ‘ä»¬åœ¨ **é˜²æ´ªåº”æ€¥é¢„æ¡ˆ** å‚ç›´é¢†åŸŸæ•°æ®ä¸Šè¿›è¡Œäº†å®Œæ•´çš„ä¸‰ç»„å¯¹æ¯”å®éªŒã€‚

*è¯¦ç»†å¯¹æ¯”æŠ¥å‘Šè§ `results/flood_comparison_report.md`*

### å®éªŒè®¾è®¡
| å®éªŒ | è¯´æ˜ | è„šæœ¬ |
|---|---|---|
| **Exp 4: Baseline** | çº¯å‘é‡+BM25æ£€ç´¢(æ— CR) | `run_flood_comparison.py` |
| **Exp 5: CR Enhanced** | å¸¦ä¸Šä¸‹æ–‡å¢å¼ºçš„æ£€ç´¢ | `run_flood_comparison.py` |
| **Exp 6: Deep KG** | çŸ¥è¯†å›¾è°±æ¨ç†æ£€ç´¢ | `create_knowledge_graph.py` + `test_kg_retrieval.py` |

## ğŸ†• Phase 2: é˜²æ´ªé¢„æ¡ˆä¸‰ç»„å¯¹æ¯”å®éªŒ

### å®éªŒé…ç½®å¯¹æ¯”

| å®éªŒ | å‘é‡æ£€ç´¢ | BM25åˆ†è¯å™¨ | ä¸Šä¸‹æ–‡å¢å¼º | çŸ¥è¯†å›¾è°± | é¢„æ„å»ºæ•°æ®åº“ |
|------|---------|-----------|-----------|----------|------------|
| **å®éªŒ4: Baseline** | âœ… bge-small-zh | âœ… Jieba | âŒ | âŒ | âŒ å®æ—¶æ„å»º |
| **å®éªŒ5: CRå¢å¼º** | âœ… bge-small-zh | âœ… Jieba | âœ… CRå‰ç¼€ (gemma2:2b) | âŒ | âœ… æ˜¯ |
| **å®éªŒ6: Deep KG** | âœ… bge-small-zh | N/A | âŒ | âœ… LlamaIndex KG | âœ… æ˜¯ |

### æ€§èƒ½ä¸å‡†ç¡®ç‡å¯¹æ¯”

| æŒ‡æ ‡ | Baseline | CRå¢å¼º | Knowledge Graph | æœ€ä½³ |
|------|----------|--------|----------------|------|
| **å¹³å‡å“åº”æ—¶é—´** | **0.04ç§’** âš¡ | 0.03ç§’ | 5.79ç§’ (æ…¢145å€) | **Baseline** |
| **å¹³å‡æ£€ç´¢å¾—åˆ†** | **0.647** âœ… | 0.495 (-23.5%) | N/A* | **Baseline** |
| **æ•°å€¼æŸ¥è¯¢å‡†ç¡®ç‡** | **75.2%** | 61.1% | å·® | **Baseline** |
| **æšä¸¾æŸ¥è¯¢å‡†ç¡®ç‡** | **69.4%** | 51.2% | å·® | **Baseline** |
| **å¤šè·³æ¨ç†** | 62.4% | 46.2% | **å®Œå…¨å¤±è´¥** | **Baseline** |
| **æ•°æ®åº“æ„å»ºæ—¶é—´** | 0ç§’ (å³æ—¶) | ~11åˆ†é’Ÿ | ~45åˆ†é’Ÿ | **Baseline** |

*\*KGå¾—åˆ†=1000.0ä½¿ç”¨ä¸åŒè®¡é‡æ–¹å¼ï¼Œæ£€ç´¢è´¨é‡å•ç‹¬è¯„ä¼°*

### ğŸ” æ ¸å¿ƒå‘ç°ï¼šBaselineé€†è½¬æ•ˆåº”

#### ğŸ¯ Baselineåè¶…CR (+30.7%)
**ä¸é˜¶æ®µä¸€ç›¸å** - åœ¨é«˜åº¦ç»“æ„åŒ–æ–‡æ¡£ä¸Šï¼Œç®€å•æ£€ç´¢è·èƒœï¼š

**Q1: æ¨å®¶æ¨ªæ°´åº“çš„æ±›é™æ°´ä½æ˜¯å¤šå°‘ï¼Ÿ**
- **Baseline**: 0.752 - "é›¨å‰æ°´ä½è¾¾æ±›é™æ°´ä½ 298.50m..." âœ… ç²¾ç¡®ç­”æ¡ˆ
- **CR**: 0.611 - "Flood control procedures and indicators..." âŒ ä¸¢å¤±æ•°å€¼
- **åŸå› **: CRçš„æ€»ç»“å‹ç¼©ä¸¢å¤±äº†å…³é”®çš„"298.50m"æ•°å€¼

**Q2: é˜²æ´ªé¢„æ¡ˆä¸­çš„åº”æ€¥é¢„æ¡ˆç­‰çº§æœ‰å“ªäº›ï¼Ÿ**
- **Baseline**: 0.694 - åˆ—å‡ºå…¨éƒ¨4çº§ï¼ˆçº¢/æ©™/é»„/è“ï¼‰âœ…
- **CR**: 0.512 - æ¦‚æ‹¬æ€§æè¿°ï¼Œæ— æšä¸¾ âŒ
- **åŸå› **: ä¸Šä¸‹æ–‡å‹ç¼©å¯¼è‡´æšä¸¾ç»†èŠ‚ä¸¢å¤±

**Q8: æ°´åº“å¤§åå‡ºç°é™©æƒ…æ—¶åº”è¯¥è”ç³»è°ï¼Ÿ**
- **Baseline**: 0.624 - æ‰¾åˆ°è”ç³»æµç¨‹ âœ…
- **CR**: 0.462 - æ¨¡ç³Šçš„ç»„ç»‡æ¶æ„ âŒ
- **KG**: è¿”å›"è´¹ç”¨æ”¶å–"ç« èŠ‚ï¼ˆå®Œå…¨ä¸ç›¸å…³ï¼‰âŒâŒ

#### âš ï¸ çŸ¥è¯†å›¾è°±å®Œå…¨å¤±æ•ˆ
å°½ç®¡å¹³å‡å“åº”æ—¶é—´5.79ç§’ï¼ˆæ¯”Baselineæ…¢145å€ï¼‰ï¼ŒKGæ£€ç´¢è´¨é‡**ç³»ç»Ÿæ€§å¾ˆå·®**ï¼š

| æŸ¥è¯¢ | KG Top-1ç»“æœ | ç›¸å…³æ€§ | é—®é¢˜ |
|------|-------------|--------|------|
| Q2 (åº”æ€¥ç­‰çº§) | ç›‘æµ‹è®¾æ–½æè¿° | âŒ ä¸ç›¸å…³ | å®ä½“æŠ½å–é”™è¯¯ |
| Q7 (è´Ÿè´£äºº) | "11.5 è´¹ç”¨æ”¶å–" | âŒ å®Œå…¨é”™è¯¯ | å›¾éå†å¤±è´¥ |
| Q3 (å·¡æŸ¥æ ‡å‡†) | æ°´ä½æ•°æ®è¡¨ | âŒ ç¦»é¢˜ | ä¸‰å…ƒç»„è´¨é‡å·® |

**æ ¹æœ¬åŸå› **ï¼š
1. **å®ä½“æŠ½å–åœ¨ä¸­æ–‡è§„ç« æ–‡æœ¬ä¸Šå¤±è´¥** - LLMæ— æ³•æ­£ç¡®è¯†åˆ«èŒè´£/è´£ä»»å®ä½“
2. **ä¸‰å…ƒç»„è´¨é‡ä¸è¶³** - "è´Ÿè´£"ç­‰å…³ç³»æœªè¢«æ•è·
3. **å›¾éå†é€»è¾‘æŸå** - å¤šè·³æŸ¥è¯¢è¿”å›éšæœºèŠ‚ç‚¹

### ğŸ’¡ å…³é”®å­¦æœ¯æ´å¯Ÿ

#### 1. æ•°æ®ç»“æ„å†³å®šCRæœ‰æ•ˆæ€§ï¼ˆé€†è½¬å‘ç°ï¼‰

| æ•°æ®ç±»å‹ | ç¤ºä¾‹ | æœ€ä½³æ–¹æ³• | CRæ•ˆæœ |
|---------|------|---------|--------|
| **éç»“æ„åŒ–** | è¯„è®ºã€èŠå¤©è®°å½• | CRå¢å¼º | âœ… +30-100% |
| **åŠç»“æ„åŒ–** | å¸¦å™è¿°çš„è¡¨æ ¼ | Baselineæˆ–CR | â‰ˆ ç›¸ä¼¼ |
| **é«˜åº¦ç»“æ„åŒ–** | è§„ç« ã€æµç¨‹ã€è¡¨å• | **Baseline** | âŒ -23.5% |

**é˜¶æ®µä¸€ vs é˜¶æ®µäºŒå¯¹æ¯”**ï¼š
```
é˜¶æ®µä¸€ï¼ˆé£Ÿå ‚ - åˆ—è¡¨æ•°æ®ï¼‰ï¼š
  Baseline: 0% (Q8å¤©æ´¥åŒ…å­) â†’ CR: 100% âœ… (+100%)
  
é˜¶æ®µäºŒï¼ˆé˜²æ´ª - ç»“æ„åŒ–æ–‡æ¡£ï¼‰ï¼š
  Baseline: 0.647 â†’ CR: 0.495 âŒ (-23.5%)
```

**ç»“è®º**: CRä»·å€¼ä¸æ–‡æ¡£ç»“æ„åŒ–ç¨‹åº¦**æˆåæ¯”**ã€‚

#### 2. KGä¸ºä½•å¤±è´¥ï¼ˆæ„å¤–å‘ç°ï¼‰
åˆå§‹å‡è®¾ï¼šKGåº”åœ¨å¤šè·³æ¨ç†ä¸Šè¡¨ç°ä¼˜å¼‚ï¼ˆå¦‚"åº”æ€¥æ—¶è°è”ç³»è°ï¼Ÿ"ï¼‰

**ç°å®**: KGåœ¨æ‰€æœ‰æŸ¥è¯¢ç±»å‹ä¸Šè¡¨ç°**æœ€å·®**ï¼ŒåŸå› ï¼š
- ä¸­æ–‡NERä¸è¶³ï¼ˆæ— æ³•æ­£ç¡®æŠ½å–"é˜²æ±›æŒ‡æŒ¥éƒ¨"ã€"è´£ä»»äºº"ï¼‰
- LlamaIndexçš„å›¾æ„å»ºé’ˆå¯¹è‹±æ–‡ç»´åŸºç™¾ç§‘å¼æ–‡æœ¬ä¼˜åŒ–
- è§„ç« æ–‡æ¡£ç¼ºä¹è‡ªç„¶å›¾ç»“æ„ï¼ˆæ›´åå‘æ ‘/å±‚çº§ï¼‰

**æ•™è®­**: KG â‰  é€šç”¨å‡çº§ã€‚éœ€è¦é¢†åŸŸç‰¹å®šçš„å®ä½“æ¨¡å¼ã€‚

#### 3. æµ‹è¯•é—®é¢˜è´¨é‡è¯„ä¼°

**è¦†ç›–åº¦åˆ†æï¼ˆ8é¢˜ï¼‰**ï¼š
- âœ… æ•°å€¼æŸ¥è¯¢: 2é¢˜ (Q1, Q6)
- âœ… æšä¸¾: 2é¢˜ (Q2, Q5)
- âœ… è§„åˆ™/æ ‡å‡†: 2é¢˜ (Q3, Q4)
- âš ï¸ å¤šè·³æ¨ç†: ä»…1é¢˜ (Q8) - **ä¸è¶³**
- âŒ è¯­ä¹‰å˜æ¢: 0é¢˜ - **ç¼ºå¤±**
- âŒ åäº‹å®: 0é¢˜ - **ç¼ºå¤±**

**æ”¹è¿›å»ºè®®**ï¼š
1. å¢åŠ 12+é¢˜ï¼ˆæ€»è®¡20-30é¢˜ï¼‰
2. åŒ…å«5+å¤šè·³æŸ¥è¯¢ï¼ˆå¦‚"æ°´åº“åˆ°299mæ—¶è°åŠ¨å‘˜å“ªä¸ªé˜Ÿä¼ï¼Ÿ"ï¼‰
3. æµ‹è¯•è¯­ä¹‰é²æ£’æ€§ï¼ˆ"æ±›é™æ°´ä½" vs "é˜²æ´ªæ§åˆ¶æ°´ä½"ï¼‰
4. å¢åŠ è´Ÿé¢æ¡ˆä¾‹ï¼ˆ"å¸¸åº„æ°´åº“çš„æ±›é™æ°´ä½?" â†’ åº”è¿”å›"æ–‡æ¡£æ˜¯æ¨å®¶æ¨ªï¼Œéå¸¸åº„"ï¼‰

### ğŸ† ç»¼åˆæ’åï¼ˆé˜¶æ®µäºŒï¼‰

1. ğŸ¥‡ **Baseline** - æœ€å¿«ã€æœ€å‡†ç¡®ã€é›¶é…ç½®æˆæœ¬
2. ğŸ¥ˆ **CRå¢å¼º** - åœ¨ç»“æ„åŒ–æ–‡æœ¬ä¸Šæ›´æ…¢ä¸”æ›´ä¸å‡†ç¡®
3. ğŸ¥‰ **Knowledge Graph** - æœ€æ…¢ã€æ£€ç´¢è´¨é‡æœ€å·®ã€éœ€å¤§å¹…ä¿®å¤

---

## ğŸ”„ ç³»ç»Ÿæµç¨‹å›¾ (System Pipeline)

```mermaid
graph LR
    A[PDF æ•°æ®] --> B[æ–‡æœ¬åˆ‡ç‰‡]
    B --> C{å¯ç”¨ CR?}
    C -->|æ˜¯| D[LLM ç”Ÿæˆä¸Šä¸‹æ–‡]
    C -->|å¦| E[åŸå§‹åˆ‡ç‰‡]
    D --> F[æ‹¼æ¥ä¸Šä¸‹æ–‡ + åŸæ–‡]
    E --> G[Embedding å‘é‡åŒ–]
    F --> G
    G --> H[å‘é‡æ•°æ®åº“ ChromaDB]
    
    subgraph æ··åˆæ£€ç´¢
    B --> I{å¯ç”¨ç»“å·´?}
    I -->|æ˜¯| J["ä¸­æ–‡åˆ†è¯<br/>(BM25)"]
    I -->|å¦| K[é»˜è®¤åˆ†è¯]
    J --> L[BM25 ç´¢å¼•]
    K --> L
    end

    subgraph "Phase 2: çŸ¥è¯†å›¾è°±"
    B --> M[å®ä½“æŠ½å–]
    M --> N[å›¾è°±æ„å»º Graph Store]
    N --> O[å›¾è°±æ¨ç†æŸ¥è¯¢]
    end
    
    H -.-> P[æœ€ç»ˆæ··åˆæ£€ç´¢]
    L -.-> P
    O -.-> P
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡
- Python 3.11+
- [Ollama](https://ollama.com/download) å·²å®‰è£…
- `gemma3:12b` (é—®ç­”) å’Œ `gemma2:2b` (ä¸Šä¸‹æ–‡ç”Ÿæˆ)

### 1. å®‰è£…ä¾èµ–
```bash
git clone https://github.com/roclee2692/contextual-retrieval-by-anthropic.git
cd contextual-retrieval-by-anthropic
pip install -r requirements.txt
```

### 2. è¿è¡Œå®éªŒï¼ˆç»Ÿä¸€è„šæœ¬ï¼‰

**æ–¹å¼ A: é£Ÿå ‚å®éªŒ (Phase 1)**
```bash
# ä¸€é”®åˆ‡æ¢é…ç½® + æ„å»ºæ•°æ®åº“ + è¿è¡Œæµ‹è¯•
python run_experiment.py canteen --build --test
```

**æ–¹å¼ B: é˜²æ´ªå®éªŒ (Phase 2)**
```bash
# è¿è¡Œå®Œæ•´ä¸‰ç»„å¯¹æ¯” (Baseline vs CR vs KG)
python scripts/phase2_three_way_comparison.py

# æˆ–è¿è¡Œå•ç‹¬å®éªŒ
python run_experiment.py flood --test  # ä»… CR
python scripts/test_kg_retrieval.py    # ä»… KG
```

**æ‰‹åŠ¨æ¨¡å¼ï¼ˆé«˜çº§ï¼‰**
```bash
# æ­¥éª¤ 1: æ‰‹åŠ¨åˆ‡æ¢é…ç½®
Copy-Item .env.canteen .env  # æˆ– .env.flood

# æ­¥éª¤ 2: æ„å»ºæ•°æ®åº“
python scripts/create_save_db.py

# æ­¥éª¤ 3: è¿è¡Œæµ‹è¯•
python scripts/test_ab_simple.py  # é£Ÿå ‚å®éªŒ
python scripts/run_flood_comparison.py  # é˜²æ´ªå®éªŒ
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
contextual-retrieval-by-anthropic/
â”œâ”€â”€ .env                    # å½“å‰ç”Ÿæ•ˆé…ç½®
â”œâ”€â”€ .env.canteen            # é£Ÿå ‚å®éªŒé…ç½®
â”œâ”€â”€ .env.flood              # é˜²æ´ªå®éªŒé…ç½®
â”œâ”€â”€ data/                   # æ•°æ®é›†
â”œâ”€â”€ src/                    # æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ contextual_retrieval/
â”‚   â”œâ”€â”€ db/                 # å‘é‡/å›¾è°±æ•°æ®åº“å­˜å‚¨
â”‚   â””â”€â”€ tools/
â””â”€â”€ results/                # å®éªŒç»“æœæŠ¥å‘Š
```

---

## ğŸ“§ è”ç³»æ–¹å¼
**ä½œè€…**ï¼šroclee2692  
**GitHub**ï¼š[@roclee2692](https://github.com/roclee2692)

**å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Starï¼**
